<% provide(:title, @user.name) %>
<div class="gravatar float-left">
  <% if user_signed_in? %>
    <a href="http://gravatar.com/emails" target="_blank"><img src="<%= @user.gravatar_url %>"></a>
  <% else %>
    <img src="<%= @user.gravatar_url %>">
  <% end %>
</div>
  <% if @user.admin %>
    <h1><%= @user.name %>'s Profile [Admin]</h1>
  <% else %>
    <h1><%= @user.name %>'s Profile</h1>
  <% end %>
  <p>Number of posts: <%= @user.posts.count %></p>
<small>
  <p>
    <span class="fas fa-heart" style="margin-right: 5px;">&ensp;<%= @user.likes.count %> posts liked</span>
    <span class="fas fa-comment">&ensp;<%= @user.comments.count %> posts commented</span>
  </p>
</small>


<br>
<% @posts.each do |post| %>
  <br>
  <div class="card mb-2">
    <div class="card-body">

      <h2 class="text-center"><%= link_to post.title, post_path(post) %></h2>

      <p class="card-text"><%= post.content %></p>

      <% if current_user == post.user or current_user.admin %>
        <h6><%= link_to "Delete", post_path(post), method: :delete, class: ' delete float-right',
                        data: {confirm: "Are you sure that you want to delete this post?"} %></h6>
        <h6><%= link_to "Edit", edit_post_path(post), class: 'float-right' %> </h6>
      <% end %>

      <% if post_already_liked(post.id) %>
        <span class="like" data-controller = "heart"><%= link_to '', post_likes_path(post), method: :post, class: 'fas fa-heart' , 'data-action' => 'click->heart#like' %> <%= post.likes.count %></span>
      <% else  %>
        <span class="like" data-controller = "heart"><%= link_to '', post_likes_path(post), method: :post, class: 'far fa-heart' , 'data-action' => 'click->heart#like' %> <%= post.likes.count %></span>
      <% end %>
      <span><%= link_to '', post_path(post), class: 'far fa-comment' %> <%= post.comments.count %> comments </span>

      <small>
        <p>
          Post by: <%= link_to post.user.name %>
          Created: <%= local_time_ago(post.created_at) %>
          <% if post.created_at != post.updated_at %>
            | Updated: <%= local_time_ago(post.updated_at) %>
          <%end %>
        </p>
      </small>
    </div>
  </div>
<% end %>

<%= will_paginate @posts %>